# Multimodal RAG (Text + Image Retrieval-Augmented Generation)

Цей проєкт реалізує мультимодальну RAG-систему на основі статей з [The Batch](https://www.deeplearning.ai/the-batch/), яка поєднує обробку тексту та зображень для побудови семантичного індексу з можливістю пошуку по обох модальностях.

---

## Мета

Реалізувати пайплайн, який:

1. Завантажує статті та пов’язані з ними зображення.
2. Виконує препроцесинг тексту (сплітинг) та конвертацію зображень.
3. Створює ембеддинги для тексту та зображень за допомогою `OpenCLIP`.
4. Зберігає ці ембеддинги в ChromaDB для подальшого мультимодального пошуку.

---

## Складові

### 1. Завантаження статей і зображень

* Скрапінг статей з The Batch через `requests` + `BeautifulSoup` (було обрано статті з рубрик ML Research та Science)
* Витягування основного контенту та посилань на релевантні зображення.
* Фільтрація небажаних форматів (SVG, GIF, логотипів тощо).

### 2. Препроцесинг

* Збереження зображень локально, конвертація в `numpy` формат.
* Текст розбивається на шматки (`RecursiveCharacterTextSplitter`) для кращої індексації.

### 3. Ембеддинг

* `OpenCLIPEmbeddingFunction` використовується як єдиний embedding-функціонал для тексту та зображень.

### 4. Створення метаданих

* Для кожного елемента додаються метадані та id.

### 5. Збереження у векторну базу

* `ChromaDB` використовується як мультимодальна векторна база.

---

## Запуск

Для коректної роботи Streamlit-додатку потрібно виконати наступні кроки:

1. Встановити залежності:

   ```bash
   pip install -r requirements.txt
   ```

2. Додати (створити) `.env` файл з Google API ключем [GoogleAPI](https://aistudio.google.com/apikey):

   ```
   GOOGLE_API=your_api_key
   ```

3. Запустити кроки 1-5 блоків коду в rag.ipynb notebook

    ОБОВ'ЯЗКОВО!!!!!!

4. Запустити Streamlit-додаток:

   ```bash
   streamlit run app.py
   ```

---

## Технології

* `Streamlit` – інтерфейс користувача
* `BeautifulSoup`, `requests` – парсинг контенту
* `PIL`, `numpy` – обробка зображень
* `OpenCLIP`, `ChromaDB` – векторне представлення та індексація
* `LangChain` – завантаження та препроцесинг документів

## Оцінка

### Підхід

Для оцінки продуктивності мультимодальної RAG-системи було проведено ручне тестування з використанням типових запитів до бази статей з The Batch. Критеріями оцінки були:

* **Релевантність текстової відповіді** до запиту.
* **Змістовність відповіді** від LLM (якщо застосовується).
* **Відповідність зображень** до тематики знайдених статей.

### Тестові приклади

| Запит користувача   | Результат                                                                                                                                              | Оцінка        |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
| `AI and emissions`  | **Стаття:** *AI and Data Center Boom Challenges Big Tech’s Emissions Targets*   **Зображення:** графік викидів CO₂                                             | ✅ Релевантно |
| `drug discovery`    | **Стаття:** *AI Co-Scientist: An Agent That Generates Research Hypotheses Aiding Drug Discovery*   **Зображення:** лабораторне обладнання                         | ✅ Релевантно |
| `energy cost of AI` | **Стаття:** *The International Energy Agency Examines the Energy Costs and Potential Savings of the AI Boom*   **Зображення:** діаграми споживання енергії | ✅ Релевантно |
